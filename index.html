<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basketball Q4 Predictor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
            color: #ff6b35;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .view-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        .view-toggle button {
            flex: 1;
            padding: 12px;
            border: none;
            background: #2a2a3e;
            color: #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 600;
        }

        .view-toggle button.active {
            background: #ff6b35;
            color: #1a1a2e;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .game-table {
            background: #2a2a3e;
            border-radius: 12px;
            padding: 20px;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            padding: 12px 8px;
            text-align: center;
            font-size: 12px;
            color: #a0a0a0;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid #3a3a4e;
        }

        td {
            padding: 15px 8px;
            text-align: center;
        }

        .team-name-cell {
            text-align: left;
            padding-left: 0;
        }

        .team-name {
            width: 100%;
            padding: 10px;
            background: #1a1a2e;
            border: 2px solid #3a3a4e;
            border-radius: 8px;
            color: #e0e0e0;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .team-name:focus {
            outline: none;
            border-color: #ff6b35;
        }

        .quarter-input {
            width: 60px;
            padding: 10px 5px;
            background: #1a1a2e;
            border: 2px solid #3a3a4e;
            border-radius: 8px;
            color: #e0e0e0;
            font-size: 16px;
            text-align: center;
            transition: all 0.3s;
        }

        .quarter-input:focus {
            outline: none;
            border-color: #ff6b35;
        }

        .quarter-input.higher {
            border-color: #4ecca3;
            background: rgba(78, 204, 163, 0.1);
        }

        .quarter-input.lower {
            border-color: #ee6c4d;
            background: rgba(238, 108, 77, 0.1);
        }

        .prediction-cell {
            font-weight: 600;
            font-size: 14px;
        }

        .prediction-value {
            display: block;
            color: #ff6b35;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .confidence {
            display: inline-block;
            padding: 3px 8px;
            background: #4ecca3;
            color: #1a1a2e;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 700;
        }

        .unsafe {
            background: #ee6c4d;
        }

        .predict-btn {
            width: auto;
            padding: 15px;
            margin-top: 20px;
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
            border: none;
            border-radius: 12px;
            color: #1a1a2e;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .predict-btn:active {
            transform: scale(0.98);
        }

        .save-btn {
            width: 100%;
            padding: 12px;
            margin-top: 15px;
            background: #4ecca3;
            border: none;
            border-radius: 8px;
            color: #1a1a2e;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .save-btn:active {
            transform: scale(0.98);
        }

        .saved-games {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .game-card {
            background: #2a2a3e;
            border-radius: 12px;
            padding: 15px;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #3a3a4e;
        }

        .game-date {
            font-size: 12px;
            color: #a0a0a0;
        }

        .game-details {
            font-size: 13px;
            color: #e0e0e0;
            margin-bottom: 10px;
        }

        .team-result {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #3a3a4e;
        }

        .team-result:last-child {
            border-bottom: none;
        }

        .team-scores {
            color: #a0a0a0;
            font-size: 12px;
        }

        .prediction-result {
            color: #ff6b35;
            font-weight: 600;
        }

        .verification {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .verification button {
            flex: 1;
            padding: 8px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .correct-btn {
            background: #4ecca3;
            color: #1a1a2e;
        }

        .incorrect-btn {
            background: #ee6c4d;
            color: #1a1a2e;
        }

        .verified {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
            margin-top: 10px;
        }

        .verified.correct {
            background: #4ecca3;
            color: #1a1a2e;
        }

        .verified.incorrect {
            background: #ee6c4d;
            color: #1a1a2e;
        }

        .no-games {
            text-align: center;
            padding: 40px;
            color: #a0a0a0;
        }

        .delete-btn {
            background: #ee6c4d;
            color: #1a1a2e;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
        }

        @media (max-width: 600px) {
            .quarter-input {
                width: 50px;
                padding: 8px 3px;
                font-size: 14px;
            }

            th, td {
                padding: 10px 5px;
                font-size: 11px;
            }

            .team-name {
                font-size: 13px;
                padding: 8px;
            }

            .prediction-value {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèÄ Q4 Predictor</h1>

        <div class="view-toggle">
            <button id="predictBtn" class="active">Predict</button>
            <button id="historyBtn">History</button>
        </div>

        <div id="predictPage" class="page active">
            <div class="game-table">
                <table>
                    <thead>
                        <tr>
                            <th>Team</th>
                            <th>Q1</th>
                            <th>Q2</th>
                            <th>Q3</th>
                            <th>Q4 Pred</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="team-name-cell">
                                <input type="text" class="team-name" id="team1Name" placeholder="Team 1">
                            </td>
                            <td>
                                <input type="number" class="quarter-input" id="team1Q1" min="0" data-team="1" data-quarter="1">
                            </td>
                            <td>
                                <input type="number" class="quarter-input" id="team1Q2" min="0" data-team="1" data-quarter="2">
                            </td>
                            <td>
                                <input type="number" class="quarter-input" id="team1Q3" min="0" data-team="1" data-quarter="3">
                            </td>
                            <td class="prediction-cell" id="team1Pred">
                                <span class="prediction-value">-</span>
                            </td>
                            <td class="prediction-cell" id="team1Total">
                                <span class="prediction-value">-</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="team-name-cell">
                                <input type="text" class="team-name" id="team2Name" placeholder="Team 2">
                            </td>
                            <td>
                                <input type="number" class="quarter-input" id="team2Q1" min="0" data-team="2" data-quarter="1">
                            </td>
                            <td>
                                <input type="number" class="quarter-input" id="team2Q2" min="0" data-team="2" data-quarter="2">
                            </td>
                            <td>
                                <input type="number" class="quarter-input" id="team2Q3" min="0" data-team="2" data-quarter="3">
                            </td>
                            <td class="prediction-cell" id="team2Pred">
                                <span class="prediction-value">-</span>
                            </td>
                            <td class="prediction-cell" id="team2Total">
                                <span class="prediction-value">-</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div style="display: flex; gap: 10px;">
                <button class="predict-btn" onclick="calculatePrediction()" style="flex: 1;">Calculate Prediction</button>
                <button class="predict-btn" onclick="resetPrediction()" style="flex: 0 0 auto; background: #2a2a3e; padding: 15px 25px;">Reset</button>
            </div>
            <div id="saveButtonContainer"></div>
        </div>

        <div id="historyPage" class="page">
            <div id="savedGames" class="saved-games"></div>
        </div>
    </div>

    <script>
        let currentPrediction = null;

        function addColorCoding() {
            for (let team = 1; team <= 2; team++) {
                const q1 = parseInt(document.getElementById(`team${team}Q1`).value) || 0;
                const q2 = parseInt(document.getElementById(`team${team}Q2`).value) || 0;
                const q3 = parseInt(document.getElementById(`team${team}Q3`).value) || 0;

                const q2Input = document.getElementById(`team${team}Q2`);
                const q3Input = document.getElementById(`team${team}Q3`);

                q2Input.classList.remove('higher', 'lower');
                q3Input.classList.remove('higher', 'lower');

                if (q2 > q1) q2Input.classList.add('higher');
                else if (q2 < q1) q2Input.classList.add('lower');

                if (q3 > q2) q3Input.classList.add('higher');
                else if (q3 < q2) q3Input.classList.add('lower');
            }
        }

        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('input', addColorCoding);
        });

        function calculateTeamPrediction(q1, q2, q3) {
            let prediction = 'unsafe';
            let confidence = 0;
            let total = 0;
            let q4Value = 0;

            if (q2 < q1 && q3 > q2) {
                prediction = 'UNDER';
                q4Value = q3 - 1;
                total = q1 + q2 + q3 + q4Value;
                confidence = 66;
            } else if (q2 > q1 && q3 > q2) {
                prediction = 'UNDER';
                q4Value = q3 - 1;
                total = q1 + q2 + q3 + q4Value;
                confidence = 76;
            } else if (q2 < q1 && q3 < q2) {
                prediction = 'OVER';
                q4Value = q3 + 1;
                total = q1 + q2 + q3 + q4Value;
                confidence = 79;
            } else if (q2 === q1 && q3 > q2) {
                prediction = 'UNDER';
                q4Value = q3 - 1;
                total = q1 + q2 + q3 + q4Value;
                confidence = 90;
            } else if (q2 > q1 && q3 === q2) {
                prediction = 'UNDER';
                q4Value = q3 - 1;
                total = q1 + q2 + q3 + q4Value;
                confidence = 90;
            }

            return { prediction, confidence, total, q4Value };
        }

        function calculatePrediction() {
            const team1Q1 = parseInt(document.getElementById('team1Q1').value) || 0;
            const team1Q2 = parseInt(document.getElementById('team1Q2').value) || 0;
            const team1Q3 = parseInt(document.getElementById('team1Q3').value) || 0;
            const team2Q1 = parseInt(document.getElementById('team2Q1').value) || 0;
            const team2Q2 = parseInt(document.getElementById('team2Q2').value) || 0;
            const team2Q3 = parseInt(document.getElementById('team2Q3').value) || 0;

            const team1Result = calculateTeamPrediction(team1Q1, team1Q2, team1Q3);
            const team2Result = calculateTeamPrediction(team2Q1, team2Q2, team2Q3);

            // Display Team 1 prediction
            const team1PredCell = document.getElementById('team1Pred');
            const team1TotalCell = document.getElementById('team1Total');

            if (team1Result.prediction === 'unsafe') {
                team1PredCell.innerHTML = '<span class="confidence unsafe">UNSAFE</span>';
                team1TotalCell.innerHTML = '<span class="prediction-value">-</span>';
            } else {
                team1PredCell.innerHTML = `
                    <span class="prediction-value">${team1Result.q4Value}</span>
                    <span class="confidence">${team1Result.confidence}%</span>
                `;
                team1TotalCell.innerHTML = `
                    <span class="prediction-value">${team1Result.prediction}<br>${team1Result.total}</span>
                `;
            }

            // Display Team 2 prediction
            const team2PredCell = document.getElementById('team2Pred');
            const team2TotalCell = document.getElementById('team2Total');

            if (team2Result.prediction === 'unsafe') {
                team2PredCell.innerHTML = '<span class="confidence unsafe">UNSAFE</span>';
                team2TotalCell.innerHTML = '<span class="prediction-value">-</span>';
            } else {
                team2PredCell.innerHTML = `
                    <span class="prediction-value">${team2Result.q4Value}</span>
                    <span class="confidence">${team2Result.confidence}%</span>
                `;
                team2TotalCell.innerHTML = `
                    <span class="prediction-value">${team2Result.prediction}<br>${team2Result.total}</span>
                `;
            }

            currentPrediction = {
                team1: document.getElementById('team1Name').value || 'Team 1',
                team2: document.getElementById('team2Name').value || 'Team 2',
                team1Scores: [team1Q1, team1Q2, team1Q3],
                team2Scores: [team2Q1, team2Q2, team2Q3],
                team1Result,
                team2Result,
                timestamp: new Date().toISOString()
            };

            // Show save button if at least one prediction is valid
            if (team1Result.prediction !== 'unsafe' || team2Result.prediction !== 'unsafe') {
                document.getElementById('saveButtonContainer').innerHTML = 
                    '<button class="save-btn" onclick="saveGame()">üíæ Save Game</button>';
            }
        }

        function saveGame() {
            if (!currentPrediction) return;

            const games = JSON.parse(localStorage.getItem('basketballGames') || '[]');
            games.unshift({ ...currentPrediction, verified: { team1: null, team2: null } });
            localStorage.setItem('basketballGames', JSON.stringify(games));

            alert('Game saved successfully!');
            loadHistory();
        }

        function loadHistory() {
            const games = JSON.parse(localStorage.getItem('basketballGames') || '[]');
            const container = document.getElementById('savedGames');

            if (games.length === 0) {
                container.innerHTML = '<div class="no-games">No saved games yet</div>';
                return;
            }

            container.innerHTML = games.map((game, index) => `
                <div class="game-card">
                    <div class="game-header">
                        <div class="game-date">${new Date(game.timestamp).toLocaleString()}</div>
                        <button class="delete-btn" onclick="deleteGame(${index})">Delete</button>
                    </div>
                    <div class="game-details">
                        <div class="team-result">
                            <div>
                                <strong>${game.team1}</strong><br>
                                <span class="team-scores">Q1: ${game.team1Scores[0]} | Q2: ${game.team1Scores[1]} | Q3: ${game.team1Scores[2]}</span>
                            </div>
                            <div style="text-align: right;">
                                ${game.team1Result.prediction !== 'unsafe' ? `
                                    <span class="prediction-result">Q4: ${game.team1Result.q4Value}</span><br>
                                    <span class="team-scores">${game.team1Result.prediction} ${game.team1Result.total} (${game.team1Result.confidence}%)</span>
                                ` : '<span class="confidence unsafe">UNSAFE</span>'}
                            </div>
                        </div>
                        ${game.team1Result.prediction !== 'unsafe' ? `
                            ${game.verified.team1 === null ? `
                                <div class="verification">
                                    <button class="correct-btn" onclick="verifyGame(${index}, 'team1', true)">‚úì Correct</button>
                                    <button class="incorrect-btn" onclick="verifyGame(${index}, 'team1', false)">‚úó Incorrect</button>
                                </div>
                            ` : `
                                <span class="verified ${game.verified.team1 ? 'correct' : 'incorrect'}">
                                    ${game.verified.team1 ? '‚úì Correct' : '‚úó Incorrect'}
                                </span>
                            `}
                        ` : ''}
                        
                        <div class="team-result" style="margin-top: 15px;">
                            <div>
                                <strong>${game.team2}</strong><br>
                                <span class="team-scores">Q1: ${game.team2Scores[0]} | Q2: ${game.team2Scores[1]} | Q3: ${game.team2Scores[2]}</span>
                            </div>
                            <div style="text-align: right;">
                                ${game.team2Result.prediction !== 'unsafe' ? `
                                    <span class="prediction-result">Q4: ${game.team2Result.q4Value}</span><br>
                                    <span class="team-scores">${game.team2Result.prediction} ${game.team2Result.total} (${game.team2Result.confidence}%)</span>
                                ` : '<span class="confidence unsafe">UNSAFE</span>'}
                            </div>
                        </div>
                        ${game.team2Result.prediction !== 'unsafe' ? `
                            ${game.verified.team2 === null ? `
                                <div class="verification">
                                    <button class="correct-btn" onclick="verifyGame(${index}, 'team2', true)">‚úì Correct</button>
                                    <button class="incorrect-btn" onclick="verifyGame(${index}, 'team2', false)">‚úó Incorrect</button>
                                </div>
                            ` : `
                                <span class="verified ${game.verified.team2 ? 'correct' : 'incorrect'}">
                                    ${game.verified.team2 ? '‚úì Correct' : '‚úó Incorrect'}
                                </span>
                            `}
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        function verifyGame(index, team, isCorrect) {
            const games = JSON.parse(localStorage.getItem('basketballGames') || '[]');
            games[index].verified[team] = isCorrect;
            localStorage.setItem('basketballGames', JSON.stringify(games));
            loadHistory();
        }

        function deleteGame(index) {
            const games = JSON.parse(localStorage.getItem('basketballGames') || '[]');
            games.splice(index, 1);
            localStorage.setItem('basketballGames', JSON.stringify(games));
            loadHistory();
        }

        document.getElementById('predictBtn').addEventListener('click', function() {
            document.getElementById('predictPage').classList.add('active');
            document.getElementById('historyPage').classList.remove('active');
            this.classList.add('active');
            document.getElementById('historyBtn').classList.remove('active');
        });

        document.getElementById('historyBtn').addEventListener('click', function() {
            document.getElementById('historyPage').classList.add('active');
            document.getElementById('predictPage').classList.remove('active');
            this.classList.add('active');
            document.getElementById('predictBtn').classList.remove('active');
            loadHistory();
        });

        loadHistory();
    </script>
</body>
</html>
